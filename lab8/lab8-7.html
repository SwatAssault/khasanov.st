<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Хасанов Р.М. ИВТ-417</title>
    <script src="jquery.js"></script>
    <link rel="stylesheet" type="text/css" href="calc.css">
</head>
<body>
    <h2><a href="lab8.php">На главную</a></h2>

    <p>Калькулятор</p>

    <p>
        <input id="input" type="text">
        <button id="delete"><<</button>
        <button id="clear">C</button>
    </p>

    <p>
        <button id="num1">1</button>
        <button id="num2">2</button>
        <button id="num3">3</button>
        <button id="plus">+</button>
    </p>

    <p>
        <button id="num4">4</button>
        <button id="num5">5</button>
        <button id="num6">6</button>
        <button id="minus">-</button>
    </p>

    <p>
        <button id="num7">7</button>
        <button id="num8">8</button>
        <button id="num9">9</button>
        <button id="mult">*</button>
    </p>

    <p>
        <button id="num0">0</button>
        <button id="dot">.</button>
        <button id="divide">/</button>
        <button id="equals">=</button>
    </p>

    <script>
        $(document).ready(function(){
            
            var input = $('#input');
            
            $('#num1').click(function(){
                input.val(input.val() + "1");
            });

            $('#num2').click(function(){
                input.val(input.val() + "2");
            });

            $('#num3').click(function(){
                input.val(input.val() + "3");
            });

            $('#num4').click(function(){
                input.val(input.val() + "4");
            });

            $('#num5').click(function(){
                input.val(input.val() + "5");
            });

            $('#num6').click(function(){
                input.val(input.val() + "6");
            });

            $('#num7').click(function(){
                input.val(input.val() + "7");
            });

            $('#num8').click(function(){
                input.val(input.val() + "8");
            });

            $('#num9').click(function(){
                input.val(input.val() + "9");
            });

            $('#num0').click(function(){
                input.val(input.val() + "0");
            });

            $('#divide').click(function(){
                input.val(input.val() + "/");
            });

            $('#plus').click(function(){
                input.val(input.val() + "+");
            });

            $('#minus').click(function(){
                input.val(input.val() + "-");
            });

            $('#mult').click(function(){
                input.val(input.val() + "*");
            });

            $('#dot').click(function(){
                input.val(input.val() + ".");
            });

            $('#equals').click(function(){
                if (!validateTerms(input.val())) {
                    alert("Введите правильное выражение");
                } else {
                    input.val(eval(input.val()));
                }
            });

            function validateTerms(string) {
                var terms = string.split(/\+|\-|\/|\*/);
                var ok = true;
                if (string.substring(0, 1) === '-' && string.substring(1, 2) === '-') {
                    ok = false;
                }
                terms.forEach(element => {
                    
                    if (element === '' && string.substring(0, 1) !== '-') {
                        ok = false;
                    }
                    if (element.slice(-1) === '.' || element.substring(0, 1) === '.') {
                        ok = false;
                    }
                });
                return ok;
            }

            $('#clear').click(function(){
                input.val('');
            });

            $('#delete').click(function(){
                input.val(input.val().substring(0, input.val().length - 1));
            });

        });
    </script>

</body>
</html>